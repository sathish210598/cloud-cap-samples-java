# Use Windows-compatible Node.js base image
FROM mcr.microsoft.com/windows/servercore:ltsc2022

# Enable PowerShell for RUN commands
SHELL ["powershell", "-Command"]

# Download and install Node.js (v20.2.0)
RUN Invoke-WebRequest -Uri "https://nodejs.org/dist/v20.2.0/node-v20.2.0-win-x64.zip" -OutFile node.zip ; `
    Expand-Archive node.zip -DestinationPath C:\ ; `
    Rename-Item -Path "C:\node-v20.2.0-win-x64" -NewName "C:\nodejs" ; `
    Remove-Item -Force node.zip

# Add Node.js to PATH
ENV PATH="C:\\nodejs;C:\\nodejs\\bin;$env:PATH"

# Set working directory
WORKDIR /app

# Copy app files
COPY . .

# Install dependencies
RUN npm install

# Expose the port (adjust if needed)
EXPOSE 3000

# Run the Node.js app
CMD ["node", "index.js"]
